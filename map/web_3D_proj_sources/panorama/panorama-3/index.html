<!DOCTYPE html>
<html>

<head>
    <title>panorama-3</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link type="text/css" rel="stylesheet" href="/panorama/stylesheet/main.css">
    <link type="text/css" rel="stylesheet" href="../map/map.css">

</head>

<body>

<div id="panorama3"></div>


<div class="map" style="position: absolute;z-index: 1;">
    <div class="img-map">
        <img src="../map/trail_menu_bg.png">
    </div>
    <div class="style_Map">

        <div class="map_1">
            <span>THE VILLAGE</span><button onclick="map_1(1)" id="btn_1" class="btn_Map_left">
            <a href="../panorama-1/index.html" style="padding: 5px 3px;"></a>
        </button>
        </div>

        <div class="map_2">
            <span>THE RIVEBANK</span><button onclick="map_1(2)" id="btn_2" class="btn_Map_left">
            <a href="../panorama-2/index.html" style="padding: 5px 3px;"></a>
        </button>
        </div>

        <div class="map_3">
            <button id="btn_3"  onclick="map_1(3)" class="btn_Map_right">
                <a href="../panorama-3/index.html" style="padding: 5px 3px;"></a>
            </button><span>THE TRAIL</span>
        </div>

        <div class="map_4">
            <span>THE NATIVES</span><button onclick="map_1(4)" id="btn_4"  class="btn_Map_left">
            <a href="../panorama-4/index.html" style="padding: 5px 3px;"></a>
        </button>
        </div>

        <div class="map_5">
            <button onclick="map_1(5)" id="btn_5"  class="btn_Map_right">
                <a href="../panorama-5/index.html" style="padding: 5px 3px;"></a>
            </button><span>THE TRAIL</span>
        </div>
    </div>
    <div class="back">
        <button  onmouseleave="zoomNomalBack()" onmouseover="zoomBigBack()" id="btn_back"  class="btn_back">
            <img  id="img_back"  class="img_back" src="../map/back.png">
            <span  id="text_back" style="font-size: 16px">BACK TO MAP</span>
        </button>
    </div>
</div>


//

<script type="module">
    import * as THREE from '../../three_library/build/three.module.js';
    import {CSS3DRenderer, CSS3DObject} from "../../three_library/examples/jsm/renderers/CSS3DRenderer.js";

    var camera, scene, renderer;
    var target = new THREE.Vector3();
    var lon = 90, lat = 0;
    var phi = 0, theta = 0;
    var touchX, touchY;
    init();
    animate();

    function init() {
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1000);
        scene = new THREE.Scene();
        var sides = [{
            url: 'image/Panorama_3_1.jpg'
            , position: [-512, 0, 0], rotation: [0, Math.PI / 2, 0]
        }, {url: 'image/Panorama_3_3.jpg', position: [512, 0, 0], rotation: [0, -Math.PI / 2, 0]}, {
            url: 'image/Panorama_3_4.jpg', position: [0, 512, 0], rotation: [Math.PI /
            2, 0, Math.PI]
        }, {
            url: 'image/Panorama_3_5.jpg',
            position: [0, -512, 0],
            rotation: [-Math.PI / 2, 0, Math.PI]
        }, {url: 'image/Panorama_3_0.jpg', position: [0, 0, 512], rotation: [0, Math.PI, 0]}, {
            url: 'image/Panorama_3_2.jpg'
            , position: [0, 0, -512], rotation: [0, 0, 0]
        }];
        for (var i = 0; i
        < sides.length; i++) {
            var side = sides[i];
            var element = document.createElement('img');
            element.width = 1026;
            element.src = side.url;
            var object = new CSS3DObject(element);
            object.position.fromArray(side.position);
            object.rotation.fromArray(side.rotation);
            scene.add(object);
        }
        renderer = new CSS3DRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById("panorama3").appendChild(renderer.domElement);
         document.addEventListener ( 'mousedown' , onDocumentMouseDown , false);
         document.addEventListener ( 'wheel' , onDocumentMouseWheel , false);
         document.addEventListener ( 'touchstart' , onDocumentTouchStart , false);
         document.addEventListener
        ('touchmove' , onDocumentTouchMove , false);
        window.addEventListener('resize', onWindowResize, false);
    }

    function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize
        (window.innerWidth, window.innerHeight);
    }

    function onDocumentMouseDown(event) {
        event.preventDefault();
        document.addEventListener('mousemove', onDocumentMouseMove, false);
        document.addEventListener('mouseup', onDocumentMouseUp, false);
    }

    function onDocumentMouseMove(event) {
        var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;
        var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;
        lon -= movementX * 0.1;
        lat += movementY
            * 0.1;
    }

    function onDocumentMouseUp() {
        document.removeEventListener('mousemove', onDocumentMouseMove);
        document.removeEventListener('mouseup', onDocumentMouseUp);
    }

    function onDocumentMouseWheel(event) {
        var fov = camera.fov + event.deltaY
            * 0.005;
        camera.fov = THREE.Math.clamp(fov, 10, 75);
        camera.updateProjectionMatrix();
    }

    function onDocumentTouchStart(event) {
        event.preventDefault();
        var touch = event.touches[0];
        touchX = touch.screenX;
        touchY = touch.screenY;
    }

    function onDocumentTouchMove(event) {
        event.preventDefault();
        var touch = event.touches[0];
        lon -= (touch.screenX - touchX) * 0.05;
        lat += (touch.screenY - touchY) * 0.05;
        touchX = touch.screenX;
        touchY = touch.screenY;
    }

    function animate() {
        requestAnimationFrame(animate); // lon +=0 .1;
        lat = Math.max(-85, Math.min(85, lat));
        phi = THREE.Math.degToRad(90 - lat);
        theta = THREE.Math.degToRad(lon);
        target.x = Math.sin(phi) * Math.cos(theta);
        target.y=Math.cos(phi)*Math.cos(phi);
        target.z=Math.sin (phi) * Math.sin (theta);
        camera.lookAt(target);
        renderer.render(scene, camera);
    } </script>
</body>

</html>